# MIS instance generator

## Getting Started

The CLI for the generator can be used as:

```bash
python3 generate.py -L19 -s0
```

which will generate the following files:

  * `instances/L19/N289_d0.8_s0.json` -- an edge list in json format
  * `instances/L19/N289_d0.8_s0.txt` -- an adjacency list in metis 4.0 format (for KaMIS)
  * `instances/L19/N289_d0.8_s0.lp` -- a cplex formulation of the instance
  * `instances/L19/N289_d0.8_s0.svg` -- vector image of the instance (for reference)
  * `instances/L19/N289_d0.8_s0.pkl` -- pickled adjacency matrix

The generator of Erdos Renyi (ER) graphs:

```bash
python3 generate_ER.py -L 21
```

which will generate the following files:
  * `instances/L21/ER/N353_d0.8_s0_r1.415.lp` -- a cplex formulation of the instance
  
The generator of rewired graphs (we rewire the edges from a UDG to pure ER graph, we incrementally rewire):
By default, it incrementally rewires in 20 steps, from 0 to 19:

```bash
python3 generate_rewired_graph.py 
```

which will generate the following files: 
 * `instances/L21/rewired/N353_d0.8_s19_r1.415_rewired0.lp` -- a cplex formulation of the instance 
 .
 .
 .
 * `instances/L21/rewired/N353_d0.8_s19_r1.415_rewired19.lp` -- a cplex formulation of the instance 

## Advanced options

Check the help option for details:

```bash
python3 generate.py -h
```

## Generating many instances

The `generate_all.sh` illustrates how to produce seed 0..500 for all odd sizes
7..25.
The parameters are: 
  * L: the length of the lattice
  * density: the filling ratio
  * r: the radius of the disk of the graph. if r=sqrt(2), this is the union-jack connectivity. 

## Solving instances

The solver produces exact solutions (and degeneracy counts = how many solutions
there are) from the json format:

```bash
python3 solver.py instances/L19/N289_d0.8_s0.json
```

Should print the solution within a few seconds:
```txt
file: instances/L19/N289_d0.8_s0.json
|mis|=89
degeneracy=42580928
first 5 solutions:
[0, 2, 4, 6, 8, 10, 12, 14, 16, 33, 35, 37, 39, 41, 43, 45, 47, 48, 64, 66, 67,
68, 70, 72, 74, 75, 90, 92, 94, 96, 98, 100, 102, 103, 105, 116, 122, 124, 126,
128, 131, 135, 137, 139, 145, 149, 154, 156, 158, 162, 165, 166, 168, 169, 176,
180, 187, 188, 189, 193, 197, 199, 201, 207, 215, 218, 220, 222, 224, 226, 228,
231, 234, 249, 252, 254, 256, 258, 259, 261, 262, 267, 276, 279, 281, 283, 285,
286, 288]
...
```

Solutions for the bigger sizes can take a few minutes to complete, however.

NOTE: Solutions for all the instances generated by `generate_all.sh` are
provided in the git repository. E.g., `instances/L19/N289_d0.8_s0.sol`.


## optimization of the instances with CPLEX. 

We use cplex (installed locally) and the code contained in jpmc-aws-rydbergatoms/generator/optimization

```bash
python3 optimization/optimize.py -L 21 -s 0 -r 1.415 -TTS -path L21
```

``` .sh scripts
./opt_MIS_cplex.sh creates instances with different L, d and r and then optimizes them and stores the results. 

./opt_MIS_rewired_cplex.sh after having created the lp files for the rewiring experiments (gradual transition from union-jack UDG graph to pure Erdos Renyi graph), this scripts optimizes all of those instances and store results 

./opt_ER_MIS_cplex.sh after having created the lp files for Erdos Renyi graphs, this scripts optimizes all of those instances and store results.

``` 

To optimize the ER graphs we ran ``` .sh scripts
opt_ER_MIS_cplex.sh 
```


And to optimize the rewired graphs ``` .sh scripts
opt_MIS_rewired_cplex.sh
```

Note that to find the relevant radius to run experiments (that means a difference in the graph itself) it can be used a util generate_all_radius

``` 
Â© 2023 Amazon Web Services, Inc.
Developed as part of an engagement with JPMorgan Chase & Co. 
